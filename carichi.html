<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Registra Carichi</title>
  <style>
    body { font-family: Arial, sans-serif; font-size: 20px; padding: 20px; }
    input[type='number'] { width: 60px; font-size: 20px; }
    label { display: block; margin: 10px 0 5px; }
    .btn { font-size: 20px; padding: 10px 20px; margin-top: 20px; }
  </style>
</head>
<body>
  <h2>Registra Carico</h2>
  <form id="caricoForm">
    <label for="struttura">Struttura:</label>
    <select name="struttura" id="struttura">
      <option value="Prati">Prati</option>
      <option value="Trastevere">Trastevere</option>
    </select>

    <label for="data">Data:</label>
    <input type="date" name="data" id="data" required><br>

    <label>Lenzuola Bianche Matrimoniali</label>
    <input type="number" name="bianche_matrimoniali" value="0">

    <label>Lenzuola Bianche Singole</label>
    <input type="number" name="bianche_singole" value="0">

    <label>Lenzuola Bambù Matrimoniali</label>
    <input type="number" name="bambu_matrimoniali" value="0">

    <label>Lenzuola Bambù Singole</label>
    <input type="number" name="bambu_singole" value="0">

    <label>Federe</label>
    <input type="number" name="federe" value="0">

    <label>Asciugamano Bidet</label>
    <input type="number" name="bidet" value="0">

    <label>Asciugamano Viso</label>
    <input type="number" name="viso" value="0">

    <label>Telo Doccia</label>
    <input type="number" name="doccia" value="0">

    <label>Tappeto Spugna</label>
    <input type="number" name="tappeto" value="0">

    <label>Cialde</label>
    <input type="number" name="cialde" value="0">

    <label>Snack Salati</label>
    <input type="number" name="salati" value="0">

    <label>Snack Dolci</label>
    <input type="number" name="dolci" value="0">

    <label>Bevande</label>
    <input type="number" name="bevande" value="0">

    <button class="btn" type="submit">Salva Carico</button>
  </form>

  <script>
    const form = document.getElementById('caricoForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const formData = new FormData(form);
      const data = {};
      formData.forEach((value, key) => {
        if (key === "struttura" || key === "data") {
          data[key] = value;
        } else {
          data[key] = parseInt(value) || 0;
        }
      });

      const response = await fetch('/api/carichi', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      if (response.ok) {
        alert("Carico salvato correttamente!");
        form.reset();
      } else {
        alert("Errore nel salvataggio!");
      }
    });
  </script>
</body>
</html>